<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xml:lang="en"
      xmlns:i18n="http://xml.zope.org/namespaces/i18n"
      xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      metal:use-macro="api.macro('kotti:templates/view/master.pt')">

  <article metal:fill-slot="content"
           class="content"
           i18n:domain="kotti_eshop"
           tal:define="shop context">

    <h1 class="shop-title">
      <a href="${api.url(shop)}">
        ${shop.title}
      </a> - 
      <a href="${api.url(shop, '@@admin')}">
        ${custom_page_title}
      </a>
    </h1>

    <div class="row">
      <div class="col col-lg-2 col-md-2 col-sm-12 col-xs 12">
        <h3>Options</h3>
        <ul>
          <li><a href="${api.url(shop,'@@edit')}">Edit basic details</a> - shop name and description</li>
          <li><a href="${api.url(shop,'@@contents')}">Edit products</a> - shop contents</li>
        </ul>
      </div>

      <div class="col col-lg-10 col-md-10 col-sm-12 col-xs 12">
        <!-- ADMIN PRODUCTS -->
        <h3>Products</h3>
        <table class="table table-condensed">
          <thead>
            <tr>
              <th>Name, description, images</th>
              <th>Price</th>
              <th>Support days</th>
              <th>Featured</th>
              <th>Status</th>
            </tr>
          </thead>
          <tbody>
            <tr tal:repeat="product products">
              <td><b>${product.title}</b> - ${product.description}
                <div class="product-gallery">
                  <div class="product-image-div"
                       tal:repeat="productimage product.get_all_images().all()">
                    <img width="150px" tal:condition="productimage.data" class="product-image"
                     src="${request.resource_url(productimage)}image" />
                  </div>
                </div>
              </td>
              <td>
                ${product.price} RON
                <p tal:condition="python: product.price_offer and product.expires_offer_date >= today">
                  (${product.price_offer} RON until ${product.expires_offer_date})
                </p>
              </td>
              <td>${product.support_days}</td>
              <td>
                <span tal:condition="product.featured is True">yes</span>
                <span tal:condition="product.featured is not True">no</span>
              </td>
              <td>${product.status}</td>
            </tr>
          </tbody>
        </table>
        <!-- ADMIN PRODUCTS -->
      </div>      
    </div>
  </article>
</html>