<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xml:lang="en"
      xmlns:i18n="http://xml.zope.org/namespaces/i18n"
      xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      metal:use-macro="api.macro('kotti:templates/view/master.pt')">

  <article metal:fill-slot="content"
           class="content"
           i18n:domain="kotti_eshop"
           tal:define="shop context">

    <h1>${context.title}</h1>
    <p class="lead">
      ${context.description}
    </p>
    <div class="products-list">
      <h2>Products</h2>
      <div tal:repeat="product shop.get_all_products()">
        <h3><a href="${api.url(product)}">${product.title}</a></h3>
        <div tal:condition="product.productcategories">
          <h4>Categories</h4>
          <ul>
            <li>
              <a href="${api.url(api.root)}@@search-products?category=${product.productcategories[0]}">
                ${product.productcategories[0]}
              </a>
              <span tal:repeat="category product.productcategories[1:]">
                , <a href="${api.url(api.root)}@@search-products?category=${category}">${category}</a>
              </span>
            </li>
          </ul>
        </div>

        <div tal:condition="product.productmaterials">
          <h4>Materials</h4>
          <ul>
            <li>
              <a href="${api.url(api.root)}@@search-products?material=${product.productmaterials[0]}">
                ${product.productmaterials[0]}
              </a>
              <span tal:repeat="material product.productmaterials[1:]">
                , <a href="${api.url(api.root)}@@search-products?material=${material}">${material}</a>
              </span>
            </li>
          </ul>
        </div>

        <div tal:condition="product.producttopics">
          <h4>Topics</h4>
          <ul>
            <li>
              <a href="${api.url(api.root)}@@search-products?topic=${product.producttopics[0]}">
                ${product.producttopics[0]}
              </a>
              <span tal:repeat="topic product.producttopics[1:]">
                , <a href="${api.url(api.root)}@@search-products?topic=${topic}">${topic}</a>
              </span>
            </li>
          </ul>
        </div>

        <div tal:condition="product.productages">
          <h4>Ages</h4>
          <ul>
            <li>
              <a href="${api.url(api.root)}@@search-products?age=${product.productages[0]}">
                ${product.productages[0]}
              </a>
              <span tal:repeat="age product.productages[1:]">
                , <a href="${api.url(api.root)}@@search-products?age=${age}">${age}</a>
              </span>
            </li>
          </ul>
        </div>

        <div tal:condition="product.tags">
          <h4>Tags</h4>
          <ul>
            <li>
              <a href="${api.url(api.root)}@@search-products?tag=${product.tags[0]}">
                ${product.tags[0]}
              </a>
              <span tal:repeat="tag product.tags[1:]">
                , <a href="${api.url(api.root)}@@search-products?tag=${tag}">${tag}</a>
              </span>
            </li>
          </ul>
        </div>
      </div>
    </div>
  </article>
</html>