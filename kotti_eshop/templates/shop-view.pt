<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xml:lang="en"
      xmlns:i18n="http://xml.zope.org/namespaces/i18n"
      xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      metal:use-macro="api.macro('kotti:templates/view/master.pt')">

  <article metal:fill-slot="content"
           class="content"
           i18n:domain="kotti_eshop"
           tal:define="shop context; shop_currency shop.currency()">

    <h1 class="shop-title">
      <a href="${api.url(shop)}">
        ${shop.title}
      </a>
    </h1>

    <p class="shop-description lead">
      ${shop.description}
    </p>
    <!-- shop carousel -->
    <div tal:condition="show_shop_carousel" class="shop-carousel-row row">
      <div class="shop-carousel-col col col-lg-12 col-md-12 col-sm-12 col-xs-12">
        <div id="shop-carousel" class="carousel slide" data-ride="carousel">
          <!-- Indicators -->
          <ol class="carousel-indicators">
            <li data-target="#shop-carousel" data-slide-to="0" class="active"></li>
            <li data-target="#shop-carousel" data-slide-to="1"></li>
            <li data-target="#shop-carousel" data-slide-to="2"></li>
            <li data-target="#shop-carousel" data-slide-to="3"></li>
          </ol>

          <!-- Wrapper for slides -->
          <div class="carousel-inner" role="listbox">
            <div class="item active">
              <img src="${request.static_url('kotti_eshop:static/images/carousel-demo-img-1.jpg')}" 
                   alt="img1">
              <div class="carousel-caption">
                Lorem ipsum dolor sit amet.
              </div>
            </div>
            <div class="item">
              <img src="${request.static_url('kotti_eshop:static/images/carousel-demo-img-2.jpg')}"
                   alt="img2">
              <div class="carousel-caption">
                Quo natus dolorum enim, eveniet fuga praesentium tenetur ea.
              </div>
            </div>
            <div class="item">
              <img src="${request.static_url('kotti_eshop:static/images/carousel-demo-img-3.jpg')}"
                   alt="img3">
              <div class="carousel-caption">
                Animi illum, magnam ipsam.
              </div>
            </div>
            <div class="item">
              <img src="${request.static_url('kotti_eshop:static/images/carousel-demo-img-4.jpg')}"
                   alt="img4">
              <div class="carousel-caption">
                Quidem veritatis harum.
              </div>
            </div>                        
          </div>

          <!-- Controls -->
          <a class="left carousel-control" href="#shop-carousel" role="button" data-slide="prev">
            <span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>
            <span class="sr-only">Previous</span>
          </a>
          <a class="right carousel-control" href="#shop-carousel" role="button" data-slide="next">
            <span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span>
            <span class="sr-only">Next</span>
          </a>
        </div>
      </div>
    </div><!-- shop carousel -->

    <div class="shop-content-row row">
      <div class="shop-categories-col col col-lg-2 col-md-2 col-sm-12 col-xs-12">
        <h3>Categories</h3>
        <ul class="list-left list-categories">
          <li tal:repeat="category shop.get_all_productcategories()">
            <a href="${api.url(shop)}@@search-products?category=${category.title}">
              ${category.title}
            </a>
            <span class="products-number">(${len(category.shopproducts)})</span>
          </li>
        </ul>
        <h3>Materials</h3>
        <ul class="list-left list-materials">
          <li tal:repeat="material shop.get_all_productmaterials()">
            <a href="${api.url(shop)}@@search-products?material=${material.title}">
              ${material.title}
            </a>
            <span class="products-number">(${len(material.shopproducts)})</span>
          </li>
        </ul>
        <h3>Topics</h3>
        <ul class="list-left list-topics">
          <li tal:repeat="topic shop.get_all_producttopics()">
            <a href="${api.url(shop)}@@search-products?topic=${topic.title}">
              ${topic.title}
            </a>
            <span class="products-number">(${len(topic.shopproducts)})</span>
          </li>
        </ul>
        <h3>Ages</h3>
        <ul class="list-left list-ages">
          <li tal:repeat="age shop.get_all_productages()">
            <a href="${api.url(shop)}@@search-products?age=${age.title}">
              ${age.title}
            </a>
            <span class="products-number">(${len(age.shopproducts)})</span>
          </li>
        </ul>
      </div>
      <div class="shop-products-col col col-lg-10 col-md-10 col-sm-12 col-xs-12">

        <!-- FEATURED PRODUCTS -->
        <div tal:condition="show_featured_products"
             class="row products-list featured-products-list">
          <h3>Featured products</h3>
          <tal:repeat repeat="product featured_products">
            <div 
              class="product-item-col product-item-col-featured col col-lg-4 col-md-6 col-sm-12 col-xs-12">

              <div class="product-gallery product-gallery-featured">
                <div class="product-image-div product-image-div-featured"
                     tal:repeat="productimage product.get_all_images().all()[:1]"><!-- only first img -->
                  <a tal:condition="productimage.data" href="${api.url(product)}">
                    <img tal:condition="productimage.data" class="product-image-thumb"
                     src="${request.resource_url(productimage)}image/span2" />
                  </a>
                </div>
              </div>

              <h3 class="product-title"><a href="${api.url(product)}">${product.title}</a></h3>

              <div class="product-details"
                   tal:define="has_price_offer python: product.price_offer and product.expires_offer_date >= today">
                <!-- simple price -->
                <h4 class="price-simple" tal:condition="has_price_offer is not True">
                  ${product.price} ${shop_currency}
                </h4>

                <!-- or old price + new price -->
                <h5 class="price-offer-old-price" tal:condition="has_price_offer">
                  <del>${product.price} ${shop_currency}</del>
                </h5>
                <p tal:condition="has_price_offer">
                  <h4 class="price-offer">${product.price_offer} ${shop_currency}</h4>
                </p>
                <h5 class="product-status">${product.quantity_status()}</h5>
              </div>

              <!-- IF Available -->
              <tal:condition condition="product.quantity > 0">
                <a class="shop-add-btn btn btn-primary" href="#add-to-cart-link">
                  Add to cart
                </a>
              </tal:condition>

              <!-- IF Not Available -->
              <tal:condition condition="product.quantity == 0">
                <a class="shop-add-btn btn btn-default" href="#add-to-wishlist-link">
                  Add to wishlist
                </a>
              </tal:condition>

            </div>
          </tal:repeat>
        </div><!-- FEATURED PRODUCTS -->

        <!-- ALL PRODUCTS or SEARCH RESULTS -->
        <div class="row products-list">
          <h3>${custom_page_title}</h3>
          <tal:repeat repeat="product products">
            <div class="product-item-col col col-lg-4 col-md-6 col-sm-12 col-xs-12">

              <div class="product-gallery">
                <div class="product-image-div"
                     tal:repeat="productimage product.get_all_images().all()[:1]"><!-- only first img -->
                  <a tal:condition="productimage.data" href="${api.url(product)}">
                    <img tal:condition="productimage.data" class="product-image-thumb"
                     src="${request.resource_url(productimage)}image/span2" />
                  </a>
                </div>
              </div>

              <h3 class="product-title"><a href="${api.url(product)}">${product.title}</a></h3>

              <div class="product-details"
                   tal:define="has_price_offer python: product.price_offer and product.expires_offer_date >= today">
                <!-- simple price -->
                <h4 class="price-simple" tal:condition="has_price_offer is not True">
                  ${product.price} ${shop_currency}
                </h4>

                <!-- or old price + new price -->
                <h5 class="price-offer-old-price" tal:condition="has_price_offer">
                  <del>${product.price} ${shop_currency}</del>
                </h5>
                <p tal:condition="has_price_offer">
                  <h4 class="price-offer">${product.price_offer} ${shop_currency}</h4>
                </p>

                <h5 class="product-status">${product.quantity_status()}</h5>
              </div>

              <!-- IF Available -->
              <tal:condition condition="product.quantity > 0">
                <a class="shop-add-btn btn btn-primary" href="#add-to-cart-link">
                  Add to cart
                </a>
              </tal:condition>

              <!-- IF Not Available -->
              <tal:condition condition="product.quantity == 0">
                <a class="shop-add-btn btn btn-default" href="#add-to-wishlist-link">
                  Add to wishlist
                </a>
              </tal:condition>
            </div>
          </tal:repeat>
        </div><!-- ALL PRODUCTS or SEARCH RESULTS -->

        <div class="row pager-row">
          <div class="pager-col col col-lg-4 col-md-6 col-sm-12 col-xs-12">
            ${my_page_pager}
          </div>
        </div>

      </div>      
    </div>
  </article>
</html>